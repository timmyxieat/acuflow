# Handoff Document 1.50: Layout Refactor and Status Slider

## Session Summary
Major refactoring of the appointment detail page layout and UI simplification. Removed preview functionality, simplified tabs, and introduced a status slider for appointment status changes.

## What Was Built/Changed

### 1. Layout Changes
- **Patient Context panel** now on the RIGHT side of SOAP editor (matching original design)
- **Width synchronization**: Created `APPOINTMENT_INFO_WIDTH = 280` constant used by both TopTabBar appointment info section and Patient Context panel
- **Tab content**: Billing and Communication tabs now render in the Patient Context panel area (same width) instead of full-width
- SOAP editor always visible regardless of active tab

### 2. Removed Preview Functionality
- Completely removed the "preview" feature from Visit Timeline
- Clicking past visits now navigates to that appointment instead of showing preview
- Removed all preview-related state: `selectedVisitId`, `previewSlideDirection`, `handleUsePastTreatment`
- Simplified keyboard navigation (removed visits zone, only SOAP zone remains)
- SOAPSections no longer shows preview content or "Use past treatment" button

### 3. TopTabBar Simplification
- Renamed tabs: "Charting", "Billing", "Communication" (removed "Schedule" tab entirely)
- Tab layout: Icon stacked above label
- Tabs positioned on right side with fixed width matching Patient Context (280px)
- Appointment info/status section expands to fill remaining width (flex-1)
- Height fixed at `h-14` to match patient info header

### 4. Status Slider
- Replaced dropdown status picker with horizontal slider
- Shows current status with left/right chevron buttons to navigate through status track
- Status order: Scheduled → Checked In → In Progress → Unsigned → Completed
- Added `onStatusChange` prop to TopTabBar (handler not yet implemented in page.tsx)

### 5. PatientCards Enhancement
- Added `selectedPatientId` prop to highlight patient even when viewing appointment from different day
- Fixes issue where patient wasn't highlighted when viewing past appointments

### 6. Time Formatting
- Changed month abbreviation from "1m ago" to "1mo ago" to avoid confusion with minutes

## Key Files Modified

| File | Changes |
|------|---------|
| `src/app/appointments/[id]/page.tsx` | Removed preview state, simplified keyboard nav, restructured tab content layout |
| `src/app/appointments/[id]/components/TopTabBar.tsx` | New StatusSlider component, removed tabs, simplified layout |
| `src/app/appointments/[id]/components/SOAPSections.tsx` | Removed preview display and props |
| `src/app/appointments/[id]/components/VisitTimeline.tsx` | Simplified to just navigate on click |
| `src/app/appointments/[id]/lib/helpers.ts` | Added `APPOINTMENT_INFO_WIDTH`, updated relative date format |
| `src/components/custom/PatientCards.tsx` | Added `selectedPatientId` prop |

## Current State
- Build passes
- Layout is: Visit History | SOAP Editor | Right Panel (Patient Context / Billing / Comms based on tab)
- Status slider UI is complete but `onStatusChange` handler in page.tsx is not implemented yet

## Pending Work / Known Issues

1. **Status slider handler**: `onStatusChange` prop added to TopTabBar but not connected in page.tsx - needs actual status change logic
2. **ScheduleTab removed**: The schedule tab was removed but `ScheduleTab` component and `scheduleData` still exist and are imported (can be cleaned up later if not needed)
3. **Unused imports**: May have some unused imports in TopTabBar (billingData, scheduleData, commsData props are passed but not used after simplification)

## Architecture Notes

### New Layout Structure
```
┌─────────────────────────────────────────────────────────────┐
│ Patient Info Header │  TopTabBar (appt info + tabs)         │
├─────────────────────┼───────────────────────────────────────┤
│                     │ Date/Time + Status Slider │ Tabs      │
│   Visit Timeline    ├───────────────────────────┴───────────┤
│                     │ SOAP Editor              │ Right Panel│
│                     │ (always visible)         │ (280px)    │
│                     │                          │            │
└─────────────────────┴──────────────────────────┴────────────┘
```

### Status Slider Flow
```
[<] Scheduled [>] → [<] Checked In [>] → [<] In Progress [>] → [<] Unsigned [>] → [<] Completed [>]
```
